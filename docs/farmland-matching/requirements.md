# 農地管理システム 要件定義書

## 📋 プロジェクト概要

### 目的
農地のポリゴンデータを地図上に表示し、耕作者情報を可視化することで、農地管理を効率化するWebシステムを構築する。

### スコープ
- 農地の位置・境界の地図表示
- 耕作者による色分け表示  
- 農地情報の検索・フィルタリング
- 統計情報の表示

### 対象地域
- 福岡県みやま市を中心とした地域

## 🎯 機能要件

### 1. 地図表示機能（必須）
- **1.1 基本地図表示**
  - 福岡県みやま市を中心とした地図の初期表示
  - ズーム機能（拡大・縮小）
  - パン機能（地図の移動）
  - 背景地図としてOpenStreetMapを使用

- **1.2 地図コントロール**
  - ズームコントロール
  - 現在地表示ボタン
  - 全体表示ボタン（みやま市全域を表示）

### 2. 農地データ表示機能（必須）
- **2.1 ポリゴン表示**
  - 農地の境界線をポリゴンとして表示
  - 耕作者ごとに異なる色で塗り分け
  - 半透明表示で背景地図を確認可能に

- **2.2 ピン表示**
  - 農地の代表点にピンマーカーを表示
  - 農地の状態に応じたピンアイコンの使い分け

- **2.3 凡例表示**
  - 耕作者と色の対応表を表示
  - 凡例の表示/非表示切り替え機能

### 3. 情報表示機能（必須）
- **3.1 ポリゴンクリック時の詳細表示**
  - ポップアップウィンドウで以下の情報を表示：
    - 住所
    - 地番
    - 面積（㎡/坪/反の単位切り替え）
    - 耕作者名
    - 農地区分（田/畑/その他）
    - 作物情報
    - 最終更新日

- **3.2 ピンクリック時の詳細表示**
  - 簡易情報をツールチップで表示
  - 詳細を見るボタンでサイドパネル表示

### 4. 検索・フィルタリング機能（必須）
- **4.1 検索機能**
  - 住所による検索
  - 地番による検索
  - 耕作者名による検索
  - 検索結果の地図上へのハイライト表示

- **4.2 フィルタリング機能**
  - 耕作者によるフィルタ
  - 農地区分によるフィルタ
  - 面積範囲によるフィルタ
  - 複数条件の組み合わせフィルタ

### 5. 統計情報表示機能（必須）
- **5.1 統計ダッシュボード**
  - 総農地面積
  - 耕作者数
  - 農地区分別の面積・件数
  - 作物別の作付面積

- **5.2 グラフ表示**
  - 円グラフ（農地区分の割合）
  - 棒グラフ（耕作者別面積）
  - 面積推移グラフ（将来実装）

## 💾 データ要件

### 農地データ
```typescript
interface Farmland {
  id: string;                    // 農地ID
  geometry: {                    // ポリゴンデータ
    type: 'Polygon';
    coordinates: number[][][];   // [経度, 緯度]の配列
  };
  properties: {
    address: string;             // 住所
    lotNumber: string;           // 地番
    area: number;                // 面積（㎡）
    farmer: {                    // 耕作者情報
      id: string;
      name: string;
      color: string;             // 表示色
    };
    landType: '田' | '畑' | 'その他';  // 農地区分
    crops: string[];             // 作物リスト
    lastUpdated: Date;           // 最終更新日
  };
  center: {                      // 代表点（ピン表示用）
    lat: number;
    lng: number;
  };
}
```

## 🎨 UI/UX要件

### レイアウト
- **ヘッダー部**
  - システム名表示
  - 検索バー
  - ユーザー情報（将来実装）

- **メインエリア**
  - 地図表示エリア（全画面）
  - サイドパネル（詳細情報表示）
  - フローティングコントロール（凡例、フィルタ）

- **フッター部**
  - 統計情報サマリー
  - 著作権表示

### デザイン要件
- レスポンシブデザイン対応
- モバイル表示最適化
- ダークモード対応（将来実装）
- アクセシビリティ対応

## 🔧 技術要件

### フロントエンド
- **フレームワーク**: Next.js 14 (App Router)
- **言語**: TypeScript
- **地図ライブラリ**: Leaflet + React-Leaflet
- **スタイリング**: Tailwind CSS
- **状態管理**: React Context / Zustand（必要に応じて）

### パフォーマンス要件
- 初期表示: 3秒以内
- ポリゴン表示: 1000件まで同時表示可能
- スムーズなズーム・パン操作（60fps維持）

### ブラウザ対応
- Chrome（最新版）
- Firefox（最新版）
- Safari（最新版）
- Edge（最新版）

## 📈 フェーズ別実装計画

### Phase 1: MVP（最小実装）
1. 基本地図表示
2. サンプルデータでのポリゴン表示
3. 基本的な情報表示（ポップアップ）

### Phase 2: 基本機能
1. 耕作者による色分け
2. 検索機能
3. フィルタリング機能
4. 凡例表示

### Phase 3: 拡張機能
1. 統計ダッシュボード
2. 詳細なフィルタリング
3. データエクスポート機能

### Phase 4: 高度な機能（将来）
1. リアルタイムデータ更新
2. 履歴管理
3. 分析機能
4. レポート生成

## 🔒 非機能要件

### セキュリティ
- HTTPS通信の使用
- 適切なCORS設定
- XSS対策

### データプライバシー
- 個人情報の適切な管理
- アクセス権限の管理（将来実装）

### 可用性
- 99%以上のアップタイム目標
- エラーハンドリングの実装

## 📝 制約事項
- オフライン動作は非対応
- IE11は非対応
- 印刷機能は初期バージョンでは非対応

## 🚀 成功基準
- ユーザーが直感的に農地情報を確認できる
- 3秒以内での初期表示
- モバイルデバイスでの快適な操作
- 耕作者別の農地管理が視覚的に理解できる