# 農地管理システム MVP要件定義書

## 📋 MVPスコープ

### 目的
農地の位置をピンで地図上に表示し、耕作者情報を確認できる最小限のプロトタイプを構築する。

### スコープ（MVP版）
- ✅ 地図の表示（OpenStreetMap）
- ✅ 農地位置のピン表示
- ✅ 耕作者情報の表示
- ❌ ~~ポリゴン表示~~（後で実装）
- ❌ ~~検索・フィルタ~~（後で実装）
- ❌ ~~統計表示~~（後で実装）

## 🎯 MVP機能要件

### 1. 地図表示機能
- **福岡県みやま市を中心とした地図表示**
  - 初期座標: 緯度 33.1525, 経度 130.4544
  - 初期ズームレベル: 13
- **基本的な地図操作**
  - ズーム（マウスホイール、ボタン）
  - パン（ドラッグ）
- **背景地図**
  - OpenStreetMapタイルの使用

### 2. ピン表示機能
- **農地位置にピンマーカーを表示**
  - 各農地の代表点にピンを配置
  - 耕作者ごとに色分けされたピン
- **ピンのクラスタリング**（オプション）
  - ズームアウト時にピンをグループ化

### 3. 情報表示機能
- **ピンクリック/ホバー時の情報表示**
  - ポップアップまたはツールチップで表示
  - 表示項目:
    - 農地番号/ID
    - 住所
    - 耕作者名
    - 面積（㎡）

## 💾 MVPデータモデル

### シンプルな農地データ
```typescript
interface FarmlandSimple {
  id: string;           // 農地ID
  position: {           // ピン位置
    lat: number;        // 緯度
    lng: number;        // 経度
  };
  farmer: {            // 耕作者情報
    id: string;
    name: string;
    color: string;     // ピンの色
  };
  info: {              // 基本情報
    address: string;   // 住所
    area: number;      // 面積（㎡）
  };
}
```

### サンプルデータ
```json
[
  {
    "id": "farm-001",
    "position": {
      "lat": 33.1525,
      "lng": 130.4544
    },
    "farmer": {
      "id": "farmer-001",
      "name": "山田太郎",
      "color": "#FF6B6B"
    },
    "info": {
      "address": "福岡県みやま市瀬高町文廣1234",
      "area": 3000
    }
  },
  {
    "id": "farm-002",
    "position": {
      "lat": 33.1530,
      "lng": 130.4550
    },
    "farmer": {
      "id": "farmer-002",
      "name": "佐藤花子",
      "color": "#4ECDC4"
    },
    "info": {
      "address": "福岡県みやま市瀬高町文廣5678",
      "area": 2500
    }
  }
]
```

## 🎨 MVP UI構成

### シンプルなレイアウト
```
┌─────────────────────────────────────────┐
│            ヘッダー（タイトルのみ）           │
├─────────────────────────────────────────┤
│                                         │
│                                         │
│              地図エリア                   │
│          （全画面表示）                   │
│                                         │
│         [ピンマーカー表示]                │
│                                         │
│                                         │
└─────────────────────────────────────────┘

凡例（フローティング）
┌──────────────┐
│ 耕作者凡例    │
│ ● 山田太郎    │
│ ● 佐藤花子    │
└──────────────┘
```

## 🔧 技術実装

### 必要なパッケージ
```json
{
  "dependencies": {
    "next": "14.x",
    "react": "18.x",
    "react-dom": "18.x",
    "leaflet": "1.9.x",
    "react-leaflet": "4.2.x",
    "@types/leaflet": "1.9.x"
  }
}
```

### ディレクトリ構造（MVP版）
```
src/
├── app/
│   ├── layout.tsx       # ルートレイアウト
│   ├── page.tsx         # メインページ（地図）
│   └── globals.css      # グローバルCSS
├── components/
│   ├── Map.tsx          # 地図コンポーネント
│   ├── FarmPin.tsx      # ピンコンポーネント
│   └── Legend.tsx       # 凡例コンポーネント
├── data/
│   └── mockData.ts      # モックデータ
└── types/
    └── index.ts         # 型定義
```

## 🚀 実装ステップ

### Step 1: 基本セットアップ
1. プロジェクト構造の作成
2. 型定義ファイルの作成
3. モックデータの準備

### Step 2: 地図表示
1. Leaflet地図コンポーネントの実装
2. OpenStreetMapタイルの設定
3. みやま市中心の初期表示

### Step 3: ピン表示
1. ピンマーカーコンポーネントの作成
2. モックデータからピンを生成
3. 耕作者による色分け

### Step 4: 情報表示
1. ポップアップコンポーネントの実装
2. クリック/ホバーイベントの設定
3. 農地情報の表示

### Step 5: UI仕上げ
1. 凡例コンポーネントの追加
2. レスポンシブ対応
3. スタイリング調整

## ✅ MVP完成条件

1. **地図が表示される**
   - みやま市が中心に表示
   - ズーム・パン操作が可能

2. **ピンが表示される**
   - 複数の農地位置にピンが表示
   - 耕作者ごとに色分け

3. **情報が確認できる**
   - ピンをクリックで詳細表示
   - 最低限の農地情報が見られる

4. **凡例が表示される**
   - 耕作者と色の対応が分かる

## 📝 今後の拡張予定

### Phase 2で追加
- ポリゴン表示（空間結合後）
- 検索機能
- フィルタリング

### Phase 3で追加
- 統計ダッシュボード
- データ編集機能
- エクスポート機能